<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PIC Board Advanced 6 Board Support Package: PBA6-BSP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PIC Board Advanced 6 Board Support Package
   &#160;<span id="projectnumber">V 1.3.1</span>
   </div>
   <div id="projectbrief">HAL- und Peripheriefunktionen für das PBA6</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Erzeugt von Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Suchen');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Suchen');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PBA6-BSP </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Download des PBA6 BSP</h2>
<p>Der Sourcecode des PBA6-BSP wird auf Github verwaltet: <a href="https://github.com/ICT-BBC/PBA6-BSP" target="_blank">https://github.com/ICT-BBC/PBA6-BSP </a></p>
<ol type="1">
<li>Öffne die <a href="https://github.com/ICT-BBC/PBA6-BSP" target="_blank">Github-Seite des PBA6-BSP</a></li>
<li>Klicke auf den Button "Clone or Download" auf der rechten Seite, über der Ordnerübersicht</li>
<li>Lade das Projekt als Zip-Datei herunter</li>
<li>Entpacke die Zip-Datei</li>
</ol>
<h2>Inhalt BSP</h2>
<p>Der entpackte Ordner enthält nun folgende Unterordner und Dateien:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Ordner / Datei  </th><th class="markdownTableHeadNone">Inhalt ------------&mdash;   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">docs  </td><td class="markdownTableBodyNone">Ordner mit der HTML-Dokumentation des Sourcecodes   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">doxygen  </td><td class="markdownTableBodyNone">Ordner mit allen benötigten Dateien für Doxygen &ndash;&gt; kann gelöscht werden   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">example  </td><td class="markdownTableBodyNone">MPLABX-Projekt Hardwaretestsoftware   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">inc  </td><td class="markdownTableBodyNone">Include-Files des BSP   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">src  </td><td class="markdownTableBodyNone">Source-Files des BSP   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">.gitignore  </td><td class="markdownTableBodyNone">Ignorierte Files der Versionsverwaltung &ndash;&gt; kann gelöscht werden   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="_l_i_c_e_n_s_e_8md.html">LICENSE.md</a>  </td><td class="markdownTableBodyNone">Lizenz &ndash;&gt; Bitte durchlesen   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="_r_e_a_d_m_e_8md.html">README.md</a>  </td><td class="markdownTableBodyNone">Rohdaten der Anleitung &ndash;&gt; kann gelöscht werden   </td></tr>
</table>
<h2>BSP-Module</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Modul  </th><th class="markdownTableHeadNone">Zweck ------------&mdash;   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ADC  </td><td class="markdownTableBodyNone">Funktionen zur Verwendung des PIC-internen Analog-Digital-Konverters.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">LCD  </td><td class="markdownTableBodyNone">Ansteuerung des DOGM162-LCDs. Mit kleinen Anpassungen auch für andere Controller und Displays verwendbar.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">UART  </td><td class="markdownTableBodyNone">Funktionen fürs Lesen und Schreiben über die UART-Schnittstelle,   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">I2C  </td><td class="markdownTableBodyNone">Lese- und Schreibfunktionen für die interne I2C-Schnittstelle.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">LM75  </td><td class="markdownTableBodyNone">Ansteuerung des Temperatursensors TCN75, welcher protokollkompatibel zum Modell LM75 ist.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">EEPROM  </td><td class="markdownTableBodyNone">Verwendung des PIC-internen EEPROMS.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">HELPERS  </td><td class="markdownTableBodyNone">Hilfs-Makros und Funktionen wie Bit setzen / löschen, Bit toggle.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">INTERRUPT  </td><td class="markdownTableBodyNone">Globale Interruptroutine. Möglichkeit zum Hinzufügen von Callbackfunktionen für Timer-, UART- und externe Interrupts.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">LOOPDELAY  </td><td class="markdownTableBodyNone">Timer-basiertes Delay. Verwendung in Zustandsmaschinen.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">EVENTS  </td><td class="markdownTableBodyNone">Funktionen zur Verwendung von zeitlichen- und Tasterevents. Anwendung in Zustandsmaschinen.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MENU  </td><td class="markdownTableBodyNone">Funktionen zur Darstellung eines Menüs auf zeichenbasierten LCDs. Verwendbar in Zustandsmaschinen.   </td></tr>
</table>
<h2>Einbinden des BSP in ein MPLABX Projekt</h2>
<ol type="1">
<li>Neues MPLABX Projekt erstellen</li>
<li>Die beiden Ordner "src" und "inc" in den Projektordner kopieren</li>
<li>Im Projekt Rechtsklick auf Source Files, danach "Add existing Item"</li>
<li>Im Browse-Dialog in den Source Ordner navigieren, alle C-Files anwählen und diese dem Projekt hinzuzufügen <b>WICHTIG!! Die Auswahl "Store path as:" muss auf "Relative" eingestellt sein</b></li>
<li>Schritte 3&amp;4 wiederholen für die Include Files</li>
<li>Neues C-File erstellen und im Ordner "src" abspeichern</li>
<li>Zur Verwendung der Library muss folgende Code-Zeile im neu erstellten C-File hinzugefügt werden:</li>
</ol>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;../inc/PBA_config.h&quot;</span></div></div><!-- fragment --><h2>BSP-Konfiguration</h2>
<p>Zur Konfiguration muss die Header-Datei <code><a class="el" href="_p_b_a__config_8h.html" title="Konfiguration des Board-Support-Packages für das PBA6. ">PBA_config.h</a></code> editiert werden. Durch ein- oder auskommentieren der defines im Abschnitt "BSP-Konfiguration" lässt sich das BSP auf die Bedürfnisse anpassen. </p><div class="fragment"><div class="line"><span class="comment">/******************** BSP-Konfiguration ***********************************************/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define PBA6</span></div><div class="line"><span class="preprocessor">#define USE_ADC_LIBRARY         </span></div><div class="line"><span class="preprocessor">#define USE_LCD_LIBRARY         </span></div><div class="line"><span class="preprocessor">#define USE_UART_LIBRARY        </span></div><div class="line"><span class="preprocessor">#define USE_I2C_LIBRARY         </span></div><div class="line"><span class="preprocessor">#define USE_LM75_LIBRARY        </span></div><div class="line"><span class="preprocessor">#define USE_EEPROM_LIBRARY      </span></div><div class="line"><span class="preprocessor">#define USE_HELPERS_LIBRARY     </span></div><div class="line"><span class="preprocessor">#define USE_INTERRUPT_LIBRARY   </span></div><div class="line"><span class="preprocessor">#define USE_LOOPDELAY_LIBRARY   </span></div><div class="line"><span class="preprocessor">#define USE_EVENTS_LIBRARY      </span></div><div class="line"><span class="preprocessor">#define USE_MENU_LIBRARY        </span></div></div><!-- fragment --><h3>Modul-Abhängigkeiten</h3>
<p>Einige Module verwenden Funktionen anderer Module und setzen deshalb voraus, dass diese ebenfalls aktiviert sind. Ist dies nicht der Fall, werden passende Fehlermeldungen ausgegeben. Die nachfolgende Tabelle gibt einen Überblick über die Abhängigkeiten.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Module  </th><th class="markdownTableHeadCenter">LCD  </th><th class="markdownTableHeadCenter">I2C  </th><th class="markdownTableHeadCenter">HELPERS  </th><th class="markdownTableHeadCenter">INTERRUPT  </th><th class="markdownTableHeadCenter">LOOPDELAY  </th><th class="markdownTableHeadCenter">EVENTS   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">LCD  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">LM75  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">LOOPDELAY  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">EVENTS  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MENU  </td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter">x  </td><td class="markdownTableBodyCenter">x   </td></tr>
</table>
<h3>STDOUT</h3>
<p>Printf-Ausgaben können entweder ans LCD oder über UART gesendet werden. Mittels Compiler-Schalter kann zwischen den beiden Varianten umgestellt werden. Zu beachten ist, dass das jeweilige BSP-Modul aktiviert sein muss. Sind weder UART- noch LCD-Modul aktiviert, müssen beide Compiler-Schalter deaktiviert werden. </p><div class="fragment"><div class="line"><span class="comment">/********** Auswahl STDOUT ****************************************************/</span></div><div class="line"><span class="preprocessor">#define STDOUT_LCD      true    </span></div><div class="line"><span class="preprocessor">//#define STDOUT_UART   true    </span></div></div><!-- fragment --><h2>Interrupts</h2>
<p>Der Mikrocontroller verfügt nur über einen Interrupt-Vektor. Die globale Interrupt-Routine ist in der Datei <code><a class="el" href="_p_b_a__interrupts_8c.html" title="Interrupt-Handler für das PBA6. ">PBA_Interrupts.c</a></code> umgesetzt. Für die wichtigsten Peripherie- Interrupts können Callback-Funktionen hinzugefügt werden. Folgende Funktionen stehen dazu zur Verfügung: </p><div class="fragment"><div class="line">uint8_t <a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gad4c052863a994c5860f16dc20c7e9489">INT_AddTmr0CallbackFnc</a>   (<a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gac1f50b73033218e5d4f51c494e0604d3">callbackFunction_t</a> p_callBackFunction);</div><div class="line">uint8_t <a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#ga61f82223ff621b1ab02faa21f408b240">INT_AddTmr1CallbackFnc</a>   (<a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gac1f50b73033218e5d4f51c494e0604d3">callbackFunction_t</a> p_callBackFunction);</div><div class="line">uint8_t <a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#ga5a622dc14a4aeff3234aa2cec52e5c1b">INT_AddTmr2CallbackFnc</a>   (<a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gac1f50b73033218e5d4f51c494e0604d3">callbackFunction_t</a> p_callBackFunction);</div><div class="line">uint8_t <a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#ga07b872b0fac91ed782cc57e63ff367c2">INT_AddUartCallbackFnc</a>   (<a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gac1f50b73033218e5d4f51c494e0604d3">callbackFunction_t</a> p_callBackFunction);</div><div class="line">uint8_t <a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gacf5041be6dd1795cfb59b76d70a5e895">INT_AddExtIntCallbackFnc</a> (<a class="code" href="group___p_b_a___i_n_t_e_r_r_u_p_t_s.html#gac1f50b73033218e5d4f51c494e0604d3">callbackFunction_t</a> p_callBackFunction);</div></div><!-- fragment --><p> Pro Timer können jeweils drei Funktionen hinterlegt werden. Die restlichen Interrupts akzeptieren nur eine Callbackfunktion. Über den Rückgabeparameter kann überprüft werden, ob die Funktion erfolgreich hinterlegt wurde.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Rückgabewert  </th><th class="markdownTableHeadNone">Bedeutung ------------&mdash;   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">Erfolg   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">Fehler, die maximale Anzahl Funktionen ist bereits erreicht   </td></tr>
</table>
<h2>Hardware initialisieren</h2>
<p>Zum Initialisieren der Hardware muss die Funktion <code><a class="el" href="group___p_b_a___c_o_n_f_i_g.html#gafb5f95002b7e470a9e29ef4f253ba56a" title="Initialisiert die PBA Hardware und Peripherie. ">PBA_Init()</a>;</code> aufgerufen werden.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;../inc/PBA_config.h&quot;</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___p_b_a___h_a_r_d_w_a_r_e_t_e_s_t.html#ga6288eba0f8e8ad3ab1544ad731eb7667">main</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___p_b_a___c_o_n_f_i_g.html#gafb5f95002b7e470a9e29ef4f253ba56a">PBA_Init</a>();     <span class="comment">/* Initialisieren der Hardware */</span></div><div class="line">    <span class="keywordflow">while</span>(1)</div><div class="line">    {</div><div class="line">                    <span class="comment">/*My Code*/</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2>Verwendung der Loopdelay-Library</h2>
<p>Nach der Initialisierung der Hardware muss das Loopdelay initialisiert werden. Dafür wird die Funktion <code>void <a class="el" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#gaf8f81c23f0bb76cfad5627ec5ecfee3d" title="Intitialisierung des Loop-Delays. ">LOOPDELAY_Init(uint16_t loopDelayTimeMS)</a>;</code> aufgerufen, wobei der Übergabeparameter dem gewünschten Loopdelay in Millisekunden (ms) entspricht. Ausgeführt wird das Delay durch die Funktion <code>void <a class="el" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#ga8d57715817acb8272eac7a57cc0bf8ae" title="Zykluszeit abwareten. ">LOOPDELAY_Wait(void)</a>;</code>. Der Benutzer ist selber verantwortlich, dass der gesamte Programmdurchlauf nicht länger als die angegebene Zykluszeit dauert.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;../inc/PBA_config.h&quot;</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___p_b_a___h_a_r_d_w_a_r_e_t_e_s_t.html#ga6288eba0f8e8ad3ab1544ad731eb7667">main</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___p_b_a___c_o_n_f_i_g.html#gafb5f95002b7e470a9e29ef4f253ba56a">PBA_Init</a>();             <span class="comment">/*Initialisieren der Hardware*/</span></div><div class="line">    <a class="code" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#gaf8f81c23f0bb76cfad5627ec5ecfee3d">LOOPDELAY_Init</a>(10);     <span class="comment">/*Loopdelay Init, loop-time=10ms*/</span></div><div class="line">    <span class="keywordflow">while</span>(1)</div><div class="line">    {</div><div class="line">        <a class="code" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#ga8d57715817acb8272eac7a57cc0bf8ae">LOOPDELAY_Wait</a>();   <span class="comment">/*Zykluszeit 10ms*/</span></div><div class="line">        <a class="code" href="group___d_e_f___l_e_d___s_u_m_m_e_r.html#gae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a>^=1;            <span class="comment">/*LED0 blinkt mit einer Frequenz von 50Hz*/</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2>Verwendung der Event-Library</h2>
<p>Die Event-Library bietet die Möglichkeit mit verschiedenen Events zu arbeiten. Folgende Events sind definiert:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Eventname  </th><th class="markdownTableHeadNone">Funktion -------------------&mdash;   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">posEdge  </td><td class="markdownTableBodyNone">Abfragen einer positiven Tasterflanke   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">negEdge  </td><td class="markdownTableBodyNone">Abfragen einer negativen Tasterflanke   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ActiveUntilMS(time)  </td><td class="markdownTableBodyNone">Nach dem ersten Aufruf nur während der angegebenen Zeit aktiv   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">TimeoutMS(time)  </td><td class="markdownTableBodyNone">Nach dem ersten Aufruf immer nach der angegebenen Zeit aktiv   </td></tr>
</table>
<p>Zur Initialisierung der Bibliothek wird die Funktion <code>void <a class="el" href="group___p_b_a___e_v_e_n_t_s.html#gaec5b207961d3f331bb644c27e84b72db" title="Events initialisieren. ">EVENTS_Init(void *p_state,events_t *p_events)</a>;</code> aufgerufen. Der Übergabeparameter <code>void *p_state</code> ist der Pointer auf die in einer Aufzählung (enum) definierten states. Der zweite Parameter ist der Pointer auf eine Struktur vom Type <a class="el" href="structevents__t.html" title=" Events ">events_t</a>. Über diese Struktur können Events erstellt und abgefragt werden. Das Loopdelay wird über die bekannte Funktion <code>void <a class="el" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#ga8d57715817acb8272eac7a57cc0bf8ae" title="Zykluszeit abwareten. ">LOOPDELAY_Wait(void)</a>;</code>aufgerufen. Zum Detektieren der Tasterflanken muss die Funktion <code><a class="el" href="group___p_b_a___e_v_e_n_t_s.html#ga926a101092ad5a3f0858546ccc11a370" title="Einlesen der Taster, Flanken Tastendrücke detektieren. ">EVENTS_Update(void)</a>;</code> zyklisch ausgeführt werden. <br />
 <b>Für zeitliche Events dürfen nur Werte die das Ein- oder Mehrfache der Zykluszeit betragen verwendet werden!</b></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;../inc/PBA_config.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define AUS         0</span></div><div class="line"><span class="preprocessor">#define EIN         1</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define LEDANZEIGE      LATD</span></div><div class="line"></div><div class="line"><span class="keyword">enum</span> {ST_TIMEOUT,ACTIVE_UNTIL, ST_POSEDGE_NEGEDGE}state=ST_TIMEOUT; <span class="comment">/*Aufzählung aller Zustände*/</span></div><div class="line"></div><div class="line"><a class="code" href="structevents__t.html">events_t</a> events;                    <span class="comment">/*Event-Struktur*/</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___p_b_a___h_a_r_d_w_a_r_e_t_e_s_t.html#ga6288eba0f8e8ad3ab1544ad731eb7667">main</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line"></div><div class="line">    <a class="code" href="group___p_b_a___c_o_n_f_i_g.html#gafb5f95002b7e470a9e29ef4f253ba56a">PBA_Init</a>();                     <span class="comment">/*Initialisierung Hardware*/</span></div><div class="line">    <a class="code" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#gaf8f81c23f0bb76cfad5627ec5ecfee3d">LOOPDELAY_Init</a>(10);             <span class="comment">/*Initialisierung Loopdelay*/</span></div><div class="line">    <a class="code" href="group___p_b_a___e_v_e_n_t_s.html#gaec5b207961d3f331bb644c27e84b72db">EVENTS_Init</a>(&amp;state,&amp;events);    <span class="comment">/*Initialisierung Events*/</span></div><div class="line"></div><div class="line">    <a class="code" href="group___d_e_f___l_e_d___s_u_m_m_e_r.html#gae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a>=EIN;</div><div class="line">    <span class="keywordflow">while</span>(1)</div><div class="line">    {</div><div class="line">        <a class="code" href="group___p_b_a___l_o_o_p_d_e_l_a_y.html#ga8d57715817acb8272eac7a57cc0bf8ae">LOOPDELAY_Wait</a>();           <span class="comment">/*Zykluszeit 10ms*/</span></div><div class="line">        <a class="code" href="group___p_b_a___e_v_e_n_t_s.html#ga926a101092ad5a3f0858546ccc11a370">EVENTS_Update</a>();            <span class="comment">/*Events aktualisieren*/</span></div><div class="line">        <span class="keywordflow">switch</span>(state)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">case</span> ST_TIMEOUT:</div><div class="line">                <span class="keywordflow">if</span>(events.<a class="code" href="structevents__t.html#aa50bc5bd88fb2b3e981e1a04512b3337">TimeoutMS</a>(3000))  <span class="comment">/*LED0 leuchtet während 3 Sekunden*/</span></div><div class="line">                {</div><div class="line">                    <a class="code" href="group___d_e_f___l_e_d___s_u_m_m_e_r.html#gae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a>=0;</div><div class="line">                    state=ST_ACTIVE_UNTIL;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            <span class="keywordflow">case</span> ST_ACTIVE_UNTIL:</div><div class="line">                <span class="keywordflow">if</span>(events.<a class="code" href="structevents__t.html#a94feecb2b079b3a8347eebd958920045">ActiveUntilMS</a>(2000))</div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span>(events.<a class="code" href="structevents__t.html#aa50bc5bd88fb2b3e981e1a04512b3337">TimeoutMS</a>(100))</div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___d_e_f___l_e_d___s_u_m_m_e_r.html#gae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a>^=1;            <span class="comment">/*LED0 blinkt mit 5Hz für 2s*/</span></div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    <a class="code" href="group___d_e_f___l_e_d___s_u_m_m_e_r.html#gae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a>=1;</div><div class="line">                    state=ST_POSEDGE_NEGEDGE;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            <span class="keywordflow">case</span> ST_POSEDGE_NEGEDGE:</div><div class="line">                <span class="keywordflow">if</span>(events.<a class="code" href="structevents__t.html#a81ad92fd153f97ca013c4566445a1c61">posEdge</a>.<a class="code" href="structtaster_byte__t.html#aed5f14c4d0cccd3913de47d7007ee9b9">switch0</a>)  <span class="comment">/*Bei jeder Tasterbetätigung wird die */</span></div><div class="line">                {                           <span class="comment">/*Ledanzeige um 1 inkrementiert*/</span></div><div class="line">                    LEDANZEIGE++;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span>(events.<a class="code" href="structevents__t.html#aae8639107550b2b745d985de8b808f24">negEdge</a>.<a class="code" href="structtaster_byte__t.html#aeaa7df1f11712093d52edc69313de5f5">switch7</a>)  <span class="comment">/*Beim loslassen des Tasters */</span></div><div class="line">                {</div><div class="line">                    LEDANZEIGE=1;           <span class="comment">/*zurücksetzen der Anzeige*/</span></div><div class="line">                    state=ST_TIMEOUT;       <span class="comment">/*Rückkehr zum 1. Zustand*/</span></div><div class="line">                }</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2>COM-Port Treiber</h2>
<p>Je nach Betriebssystem und Konfiguration wird der Treiber für den USB-Seriell-Wandler FT232R nicht automatisch installiert. Die Virtual Com Port (VCP) Treiber können im <a href="http://www.ftdichip.com/Drivers/VCP.htm" target="_blank">Downloadbereich</a> von FTDI Chip heruntergeladen werden. <br />
 Für ungeübte Benutzer stellt der Hersteller <a href="http://www.ftdichip.com/Support/Documents/InstallGuides.htm" target="_blank">Installationsanleitungen</a> für alle gängigen Betriebssysteme zur Verfügung. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Erzeugt von
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-34805717-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
